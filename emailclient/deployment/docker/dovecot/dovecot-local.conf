# Dovecot Local Configuration Overrides
# Applied after main dovecot.conf during container startup
# Use for environment-specific settings and Docker-specific tuning

##
## Docker Environment Adjustments
##

# Allow root login for testing (DEVELOPMENT ONLY - disable in production)
# This is set via environment variable during container startup
# skip_userdb_check = no

# Reduce idle timeout for container environments
imap_idle_notify_interval = 5 mins

# Connection timeout handling
mail_max_userip_connections = 20

##
## Performance Tuning for Container
##

# Cache settings for Docker environments (lower memory footprint)
mail_cache_min_mail_count = 10
mail_vhash_size = 1024
mail_index_log_loop_wait = 5 secs

##
## Debug Logging (set via environment variable)
##

# Uncomment for development debugging
# auth_debug = yes
# mail_debug = yes
# verbose_ssl = yes
# imap_raw_log_dir = /var/log/dovecot
# pop3_raw_log_dir = /var/log/dovecot

##
## TLS Certificate Paths (set via volumes)
##

# Override if custom certificates provided via volumes
# ssl_cert = </etc/dovecot/certs/custom.crt
# ssl_key = </etc/dovecot/private/custom.key

##
## Virtual User Support (LDAP integration)
##

# LDAP authentication (commented - use static file by default)
# To enable LDAP:
# 1. Uncomment below
# 2. Set DOVECOT_LDAP_* environment variables
# 3. Rebuild container
#
# userdb {
#   driver = ldap
#   args = /etc/dovecot/dovecot-ldap.conf
# }
#
# passdb {
#   driver = ldap
#   args = /etc/dovecot/dovecot-ldap.conf
# }

##
## Postfix Integration Verification
##

# Verify LMTP socket location matches Postfix configuration
# Postfix expects: unix_listener /var/spool/postfix/private/dovecot-lmtp

##
## Monitoring and Health Checks
##

# Enable mail user statistics for monitoring
mail_plugins = $mail_plugins notify mail_log stats

protocol imap {
  mail_plugins = $mail_plugins imap_stats
}

##
## Message Size Limits
##

# Maximum message size (100 MB)
mail_max_userip_connections = 10

# Set via environment: DOVECOT_MESSAGE_SIZE_LIMIT

##
## Container Log Output
##

# Ensure logs appear in container output
log_path = /dev/stderr
info_log_path = /dev/stderr
debug_log_path = /dev/stderr

# Disable file-based logging in container
# Instead use stderr for Docker log aggregation
