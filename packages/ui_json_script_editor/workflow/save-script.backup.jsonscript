{
  "version":"2.2.0","name":"Save JSON Script","description":"Save JSON Script with permission checks (god/supergod only)","trigger":{"type":"http","method":"POST","path":"/json-editor/save"},"nodes":[{"id":"check_permission","type":"operation","op":"condition","condition":"{{ $context.user.level >= 3 }}"},{"id":"validate_input","type":"operation","op":"validate","input":"{{ $json }}","rules":{"name":"required|string","script":"required|string"}},{"id":"create_script","type":"operation","op":"database_create","entity":"JSONScript","data":{"tenantId":"{{ $context.tenantId }}","createdBy":"{{ $context.user.id }}","name":"{{ $json.name }}","description":"{{ $json.description }}","script":"{{ $json.script }}","createdAt":"{{ new Date().toISOString() }}"}},{"id":"return_success","type":"action","action":"http_response","status":201,"body":{"id":"{{ $steps.create_script.output.id }}","message":"Script saved"}}]
}
