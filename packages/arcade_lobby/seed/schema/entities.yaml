# Arcade Lobby Schema Definitions
# Package: arcade_lobby
# Version: 1.0.0

entities:
  - name: Game
    description: Game definition for the arcade lobby
    fields:
      - name: id
        type: String
        required: true
        primary: true
      - name: tenantId
        type: String
        required: true
      - name: name
        type: String
        required: true
      - name: slug
        type: String
        required: true
      - name: description
        type: String
        required: false
      - name: thumbnail
        type: String
        required: false
      - name: category
        type: String
        required: true
      - name: minPlayers
        type: Int
        required: true
        default: 1
      - name: maxPlayers
        type: Int
        required: true
        default: 1
      - name: config
        type: Json
        required: false
        description: Game-specific configuration
      - name: isActive
        type: Boolean
        required: true
        default: true
      - name: playCount
        type: Int
        required: true
        default: 0
      - name: createdAt
        type: DateTime
        required: true
      - name: updatedAt
        type: DateTime
        required: true
    indexes:
      - name: game_tenant_slug_idx
        fields: [tenantId, slug]
        unique: true
      - name: game_tenant_category_idx
        fields: [tenantId, category]
    acl:
      create: [admin]
      read: [public]
      update: [admin]
      delete: [admin]

  - name: LeaderboardEntry
    description: High score entry for a game
    fields:
      - name: id
        type: String
        required: true
        primary: true
      - name: tenantId
        type: String
        required: true
      - name: gameId
        type: String
        required: true
      - name: userId
        type: String
        required: true
      - name: username
        type: String
        required: true
      - name: score
        type: Int
        required: true
      - name: metadata
        type: Json
        required: false
        description: Game-specific score metadata
      - name: submittedAt
        type: DateTime
        required: true
    indexes:
      - name: leaderboard_game_score_idx
        fields: [gameId, score]
      - name: leaderboard_game_user_idx
        fields: [gameId, userId]
    relations:
      - name: game
        type: belongsTo
        target: Game
        foreignKey: gameId
    acl:
      create: [user]
      read: [public]
      update: [none]
      delete: [admin]

  - name: GameSession
    description: Multiplayer game session/lobby
    fields:
      - name: id
        type: String
        required: true
        primary: true
      - name: tenantId
        type: String
        required: true
      - name: gameId
        type: String
        required: true
      - name: hostId
        type: String
        required: true
      - name: status
        type: String
        required: true
        description: waiting, playing, finished
      - name: maxPlayers
        type: Int
        required: true
      - name: currentPlayers
        type: Int
        required: true
        default: 1
      - name: players
        type: Json
        required: true
        description: Array of player user IDs
      - name: createdAt
        type: DateTime
        required: true
      - name: startedAt
        type: DateTime
        required: false
      - name: endedAt
        type: DateTime
        required: false
    indexes:
      - name: session_game_status_idx
        fields: [gameId, status]
    relations:
      - name: game
        type: belongsTo
        target: Game
        foreignKey: gameId
    acl:
      create: [user]
      read: [user]
      update: [owner, admin]
      delete: [owner, admin]
