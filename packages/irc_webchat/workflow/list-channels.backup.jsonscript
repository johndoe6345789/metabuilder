{
  "version":"2.2.0","name":"List IRC Channels","description":"List IRC channels with mode filtering (public/private/secret)","trigger":{"type":"http","method":"GET","path":"/irc/channels"},"nodes":[{"id":"validate_context","type":"operation","op":"validate","input":"{{ $context.tenantId }}","validator":"required"},{"id":"extract_params","type":"operation","op":"transform_data","output":{"includePrivate":"{{ $context.user.level >= 2 }}","includeSecret":"{{ $context.user.level >= 3 }}"}},{"id":"build_filter","type":"operation","op":"transform_data","output":{"tenantId":"{{ $context.tenantId }}","mode":{"$in":"{{ [$steps.extract_params.output.includeSecret ? 'secret' : null, $steps.extract_params.output.includePrivate ? 'private' : null, 'public'].filter(x => x) }}"}}},{"id":"fetch_channels","type":"operation","op":"database_read","entity":"IRCChannel","params":{"filter":"{{ $steps.build_filter.output }}","sort":{"createdAt":-1}}},{"id":"return_success","type":"action","action":"http_response","status":200,"body":{"channels":"{{ $steps.fetch_channels.output }}"}}]
}
