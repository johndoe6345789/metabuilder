# Schema Editor Schema Definitions
# Package: schema_editor
# Version: 1.0.0

entities:
  - name: EntitySchema
    description: Dynamic entity schema definition
    fields:
      - name: id
        type: String
        required: true
        primary: true
      - name: tenantId
        type: String
        required: true
      - name: name
        type: String
        required: true
        description: Entity name
      - name: fields
        type: Json
        required: true
        description: Array of field definitions
      - name: indexes
        type: Json
        required: false
        description: Array of index definitions
      - name: relations
        type: Json
        required: false
        description: Array of relation definitions
      - name: acl
        type: Json
        required: false
        description: Access control rules
      - name: version
        type: Int
        required: true
        default: 1
      - name: createdAt
        type: DateTime
        required: true
      - name: updatedAt
        type: DateTime
        required: true
    indexes:
      - name: entity_schema_tenant_name_idx
        fields: [tenantId, name]
        unique: true
    acl:
      create: [admin]
      read: [admin]
      update: [admin]
      delete: [admin]

  - name: SchemaVersion
    description: Schema version history for rollback
    fields:
      - name: id
        type: String
        required: true
        primary: true
      - name: tenantId
        type: String
        required: true
      - name: entityName
        type: String
        required: true
      - name: version
        type: Int
        required: true
      - name: snapshot
        type: Json
        required: true
        description: Complete schema snapshot
      - name: changeNote
        type: String
        required: false
      - name: createdAt
        type: DateTime
        required: true
    indexes:
      - name: schema_version_entity_idx
        fields: [tenantId, entityName, version]
        unique: true
    acl:
      create: [system]
      read: [admin]
      update: [none]
      delete: [admin]
