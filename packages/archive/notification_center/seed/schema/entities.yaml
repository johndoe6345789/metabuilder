# Schema definitions owned by notification_center package

entities:
  - name: Notification
    version: "1.0"
    description: "User notification for alerts, messages, and system events"
    checksum: null
    
    fields:
      id:
        type: cuid
        primary: true
        generated: true
        
      tenantId:
        type: string
        required: true
        index: true
        
      userId:
        type: string
        required: true
        index: true
        
      type:
        type: string
        required: true
        enum: [info, warning, success, error, mention, reply, follow, like, system]
        
      title:
        type: string
        required: true
        maxLength: 200
        
      message:
        type: string
        required: true
        
      icon:
        type: string
        nullable: true
        
      read:
        type: boolean
        default: false
        index: true
        
      data:
        type: string
        nullable: true
        description: "JSON: action URLs, entity refs, etc."
        
      createdAt:
        type: bigint
        required: true
        index: true
        
      expiresAt:
        type: bigint
        nullable: true
        index: true

    indexes:
      - fields: [tenantId]
      - fields: [userId, read]
      - fields: [createdAt]

    relations:
      - name: tenant
        type: belongsTo
        entity: Tenant
        field: tenantId
        onDelete: Cascade
      - name: user
        type: belongsTo
        entity: User
        field: userId
        onDelete: Cascade

    acl:
      create: [system, admin]
      read: [self]
      update: [self]
      delete: [self]
      rowLevel: "userId = $user.id"
