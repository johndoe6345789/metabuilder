# Social Hub Schema Definitions
# Package: social_hub
# Version: 1.0.0

entities:
  - name: SocialProfile
    description: User social profile
    fields:
      - name: id
        type: String
        required: true
        primary: true
      - name: tenantId
        type: String
        required: true
      - name: userId
        type: String
        required: true
      - name: displayName
        type: String
        required: true
      - name: bio
        type: String
        required: false
      - name: avatar
        type: String
        required: false
      - name: links
        type: Json
        required: false
        description: Social media links
      - name: settings
        type: Json
        required: false
        description: Privacy settings
      - name: createdAt
        type: DateTime
        required: true
      - name: updatedAt
        type: DateTime
        required: true
    indexes:
      - name: profile_tenant_user_idx
        fields: [tenantId, userId]
        unique: true
    acl:
      create: [user]
      read: [public]
      update: [owner]
      delete: [owner, admin]

  - name: SocialConnection
    description: Follow relationship between users
    fields:
      - name: id
        type: String
        required: true
        primary: true
      - name: tenantId
        type: String
        required: true
      - name: followerId
        type: String
        required: true
        description: User doing the following
      - name: followingId
        type: String
        required: true
        description: User being followed
      - name: createdAt
        type: DateTime
        required: true
    indexes:
      - name: connection_follower_idx
        fields: [tenantId, followerId]
      - name: connection_following_idx
        fields: [tenantId, followingId]
      - name: connection_unique_idx
        fields: [tenantId, followerId, followingId]
        unique: true
    acl:
      create: [user]
      read: [user]
      update: [none]
      delete: [owner]

  - name: SocialActivity
    description: User activity feed item
    fields:
      - name: id
        type: String
        required: true
        primary: true
      - name: tenantId
        type: String
        required: true
      - name: userId
        type: String
        required: true
      - name: type
        type: String
        required: true
        description: post, like, comment, follow, etc.
      - name: content
        type: String
        required: false
      - name: targetId
        type: String
        required: false
        description: Reference to target object
      - name: targetType
        type: String
        required: false
        description: Type of target object
      - name: metadata
        type: Json
        required: false
      - name: createdAt
        type: DateTime
        required: true
    indexes:
      - name: activity_tenant_user_idx
        fields: [tenantId, userId]
      - name: activity_created_idx
        fields: [tenantId, createdAt]
    acl:
      create: [user]
      read: [user]
      update: [none]
      delete: [owner, admin]

  - name: SocialLike
    description: Like on content
    fields:
      - name: id
        type: String
        required: true
        primary: true
      - name: tenantId
        type: String
        required: true
      - name: userId
        type: String
        required: true
      - name: targetId
        type: String
        required: true
      - name: targetType
        type: String
        required: true
      - name: createdAt
        type: DateTime
        required: true
    indexes:
      - name: like_target_idx
        fields: [tenantId, targetId]
      - name: like_user_target_idx
        fields: [tenantId, userId, targetId]
        unique: true
    acl:
      create: [user]
      read: [user]
      update: [none]
      delete: [owner]
